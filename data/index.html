<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 Turing Machine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ ESP32 Turing Machine</h1>
            <p class="subtitle">Simulador de M√°quina de Turing Embarcada</p>
        </header>

        <!-- Se√ß√£o 1: Configura√ß√£o de Alfabetos -->
        <section class="card">
            <h2>üìù Configura√ß√£o de Alfabetos</h2>

            <div class="input-group">
                <label for="machine-name">Nome da M√°quina:</label>
                <input type="text" id="machine-name" placeholder="Ex: Verificador de Pal√≠ndromo Bin√°rio" maxlength="100">
                <small>Nome descritivo para identificar esta MT</small>
            </div>

            <div class="input-group">
                <label for="machine-description">
                    Descri√ß√£o
                    <button type="button" onclick="toggleDescription()" class="btn-toggle" style="font-size: 0.8rem; padding: 2px 8px; margin-left: 8px;">‚ñº Mostrar</button>
                </label>
                <textarea id="machine-description" placeholder="Ex: Verifica se uma string bin√°ria √© um pal√≠ndromo" rows="2" maxlength="500" style="display: none;"></textarea>
            </div>

            <div class="input-group">
                <label for="alphabet">Alfabeto de Entrada:</label>
                <input type="text" id="alphabet" placeholder="Ex: 01" maxlength="20">
                <small>S√≠mbolos aceitos na entrada (apenas alfanum√©ricos)</small>
            </div>

            <div class="input-group">
                <label for="tape-alphabet">Alfabeto Auxiliar:</label>
                <input type="text" id="tape-alphabet" placeholder="Ex: xy" maxlength="20">
                <small>S√≠mbolos extras para manipula√ß√£o. S√≠mbolos '^' (in√≠cio) e '_' (branco) j√° inclu√≠dos.</small>
            </div>

            <button id="generate-table" class="btn btn-primary">Gerar Tabela de Transi√ß√µes</button>
        </section>

        <!-- Se√ß√£o 2: Gerenciamento de Estados -->
        <section class="card" id="states-section" style="display: none;">
            <h2>üîÑ Estados da M√°quina</h2>

            <div id="states-container" class="states-grid">
                <!-- Estado inicial q0 (sempre presente) -->
                <div class="state-item state-initial" data-state="q0">
                    <span class="state-name">‚Üí q0</span>
                    <span class="state-label">(inicial)</span>
                </div>
            </div>

            <div class="button-group">
                <button id="add-state-btn" class="btn btn-secondary">+ Estado Normal</button>
                <button id="add-final-state-btn" class="btn btn-success">+ Estado Final</button>
                <button id="delete-last-state-btn" class="btn btn-danger">Deletar √öltimo</button>
            </div>

            <div class="info-box">
                <div class="info-item">
                    <strong>Estado Inicial:</strong>
                    <span id="initial-state-display">q0</span>
                </div>
                <div class="info-item">
                    <strong>Estados Finais:</strong>
                    <span id="final-states-display">Nenhum</span>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o 3: Tabela de Transi√ß√µes -->
        <section class="card" id="transitions-section" style="display: none;">
            <h2>üìä Tabela de Transi√ß√µes</h2>

            <div class="table-wrapper">
                <table id="transition-table">
                    <thead>
                        <tr>
                            <th>Estado Atual</th>
                            <th>S√≠mbolo Lido</th>
                            <th>Novo Estado</th>
                            <th>Novo S√≠mbolo</th>
                            <th>Dire√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody id="transition-body">
                        <!-- Preenchido dinamicamente pelo JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Se√ß√£o 4: Visualiza√ß√£o da M√°quina -->
        <section class="card" id="visualization-section" style="display: none;">
            <h2>üëÅÔ∏è Visualiza√ß√£o da Tabela</h2>

            <div class="table-wrapper">
                <table id="visualization-table">
                    <thead id="visualization-head">
                        <!-- Preenchido dinamicamente -->
                    </thead>
                    <tbody id="visualization-body">
                        <!-- Preenchido dinamicamente -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Se√ß√£o 5: Execu√ß√£o -->
        <section class="card" id="execution-section" style="display: none;">
            <h2>‚ñ∂Ô∏è Executar M√°quina de Turing</h2>

            <div class="input-group">
                <label for="input-tape">Entrada (fita inicial):</label>
                <input type="text" id="input-tape" placeholder="Ex: 101">
                <small>Digite a string de entrada para processar</small>
            </div>

            <div class="button-group">
                <button id="run-machine-btn" class="btn btn-primary">‚ñ∂Ô∏è Executar no Servidor</button>
                <button id="run-display-btn" class="btn btn-accent">üì∫ Executar no Display OLED</button>
                <button onclick="startStepMode()" class="btn btn-secondary">üîÑ Iniciar Modo Passo a Passo</button>
            </div>

            <div id="result-box" class="result-box" style="display: none;">
                <h3>Resultado:</h3>
                <pre id="result-content"></pre>
            </div>
        </section>

        <!-- Se√ß√£o 6: Salvar/Carregar -->
        <section class="card">
            <h2>üíæ Gerenciar Configura√ß√µes</h2>

            <div class="input-group">
                <label for="file-name">Nome do arquivo:</label>
                <input type="text" id="file-name" placeholder="minha_maquina" value="machine">
                <small>.json ser√° adicionado automaticamente</small>
            </div>

            <div class="button-group">
                <button id="save-machine-btn" class="btn btn-success">üíæ Salvar no ESP32</button>
                <button id="load-machine-btn" class="btn btn-secondary">üìÇ Carregar do ESP32</button>
                <button id="copy-json-btn" class="btn btn-secondary">üìã Copiar JSON</button>
            </div>

            <div id="saved-files-section" style="margin-top: 20px; display: none;">
                <h3>Arquivos Salvos:</h3>
                <ul id="saved-files-list"></ul>
            </div>
        </section>

        <!-- Rodap√© -->
        <footer>
            <p>ESP32 Turing Machine v2.0 | TCC - Ci√™ncia da Computa√ß√£o</p>
            <p id="connection-status" class="status-indicator">‚ö™ Desconectado</p>
        </footer>
    </div>

    <!-- Notifica√ß√µes Toast -->
    <div id="toast-container"></div>

    <script src="script.js"></script>
</body>
</html>
